{
  "id": 349,
  "title": "nginx -  common configurations to block sql injections and other attacks",
  "created": "2022-06-29T22:41:01Z",
  "modified": "2022-07-02T04:14:02Z",
  "code": [
    "# common nginx configuration to block sql injection and other attacks",
    "location ~* \"(eval\\()\" {",
    "    deny all;",
    "}",
    "location ~* \"(127\\.0\\.0\\.1)\" {",
    "    deny all;",
    "}",
    "location ~* \"([a-z0-9]{2000})\" {",
    "    deny all;",
    "}",
    "location ~* \"(javascript\\:)(.*)(\\;)\" {",
    "    deny all;",
    "}",
    "",
    "location ~* \"(base64_encode)(.*)(\\()\" {",
    "    deny all;",
    "}",
    "location ~* \"(GLOBALS|REQUEST)(=|\\[|%)\" {",
    "    deny all;",
    "}",
    "location ~* \"(<|%3C).*script.*(>|%3)\" {",
    "    deny all;",
    "}",
    "location ~ \"(\\\\|\\.\\.\\.|\\.\\./|~|`|<|>|\\|)\" {",
    "    deny all;",
    "}",
    "location ~* \"(boot\\.ini|etc/passwd|self/environ)\" {",
    "    deny all;",
    "}",
    "location ~* \"(thumbs?(_editor|open)?|tim(thumb)?)\\.php\" {",
    "    deny all;",
    "}",
    "location ~* \"(\\'|\\\")(.*)(drop|insert|md5|select|union)\" {",
    "    deny all;",
    "}",
    "location ~* \"(https?|ftp|php):/\" {",
    "    deny all;",
    "}",
    "location ~* \"(=\\\\\\'|=\\\\%27|/\\\\\\'/?)\\.\" {",
    "    deny all;",
    "}",
    "location ~ \"(\\{0\\}|\\(/\\(|\\.\\.\\.|\\+\\+\\+|\\\\\\\"\\\\\\\")\" {",
    "    deny all;",
    "}",
    "location ~ \"(~|`|<|>|:|;|%|\\\\|\\s|\\{|\\}|\\[|\\]|\\|)\" {",
    "    deny all;",
    "}",
    "location ~* \"/(=|\\$&|_mm|(wp-)?config\\.|cgi-|etc/passwd|muieblack)\" {",
    "    deny all;",
    "}",
    "",
    "location ~* \"(&pws=0|_vti_|\\(null\\)|\\{\\$itemURL\\}|echo(.*)kae|etc/passwd|eval\\(|self/environ)\" {",
    "    deny all;",
    "}",
    "location ~* \"/(^$|mobiquo|phpinfo|shell|sqlpatch|thumb|thumb_editor|thumbopen|timthumb|webshell|config|settings|configuration)\\.php\" {",
    "    deny all;",
    "}"
  ],
  "example": "",
  "output": "",
  "description": [
    "https://www.acunetix.com/blog/web-security-zone/hardening-nginx/"
  ],
  "language": "nginx",
  "tags": null,
  "url": "https://gist.github.com/nfsarmento/57db5abba08b315b67f174cd178bea88"
}
